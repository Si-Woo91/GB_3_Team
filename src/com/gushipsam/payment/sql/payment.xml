<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Payment">
	
	<select id="getCartList" parameterType="string" resultType="cartdto">
		SELECT c.CID , c.GID , c.CQTY, g.GNAME , g.GBRAND , g.GPRICE 
		FROM CART c 
			LEFT OUTER JOIN MEMBERS m 	ON c.USERID = m.USERID 
			LEFT OUTER JOIN GOODS g 	ON c.GID = g.GID 
		WHERE c.USERID = #{userid}
		ORDER BY cID DESC
	</select>
	
	<select id="getCheckoutList" parameterType="hashmap" resultType="cartdto">
		SELECT c.CID , c.GID , c.CQTY, g.GNAME , g.GBRAND , g.GPRICE 
		FROM CART c 
			LEFT OUTER JOIN MEMBERS m 	ON c.USERID = m.userid 
			LEFT OUTER JOIN GOODS g 	ON c.GID = g.GID 
		WHERE c.USERID = #{userid}
		AND 	c.CID IN 
		<foreach collection="cIDs" item="cID" open="(" separator="," close=")">
				#{cID}
		</foreach>
		ORDER BY cID DESC
	</select>
	
	<select id="getMemberInfo" parameterType="string" resultType="memberdto">
		SELECT * FROM MEMBERS
		WHERE USERID = #{userid}
	</select>
	
	<select id="deleteCartItem" parameterType="hashmap">
		DELETE FROM CART
		WHERE USERID = #{userid}
		AND cID = #{del_cID}
	</select>
	
	<select id="getCartItem" parameterType="string" resultType="cartdto">
		SELECT *
		FROM CART
		WHERE cID = #{cID}
	</select>
	
	<insert id="insertOrder" parameterType="orderdto">
		INSERT INTO ORDERS VALUES(order_seq.nextval,#{userid},#{gID},#{oQTY},SYSDATE,#{oPHONE},#{oADDRESS})
	</insert>
	
	
	<select id="deleteCartItemAll" parameterType="hashmap">
		DELETE FROM CART
		WHERE USERID = #{userid}
		AND 	CID IN 
		<foreach collection="cIDs" item="cID" open="(" separator="," close=")">
				#{cID}
		</foreach>
	</select>

</mapper>
























